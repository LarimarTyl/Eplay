<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>入驻管理</title>
    <link rel="stylesheet" href="../../dist/css/bootstrap.css">
    <script src="../../dist/js/jquery-3.4.1.js"></script>
    <script src="../../dist/js/bootstrap.js"></script>
    <link rel="stylesheet" href="../../css/admin-item.css">
    <link rel="stylesheet" href="../../css/player.css">
</head>
<body>
    <h1>入驻管理</h1>
    <br>
    <div class="panel panel-default">
		<!-- 搜索部分 -->
			<div class="panel-body">
				<form class="form-inline" method="get" action="">
					<div class="form-group">
						<label for="">主播名称</label> 
						<input type="text" class="form-control" id="" value="" name="">
					</div>
					<button type="submit" class="btn btn-primary">查询</button>
				</form>
			</div>
		</div>
		<a href="#" class="btn btn-primary" data-toggle="modal" data-target="#newplayerDialog" onclick="clearDept()">新建</a>
    <table class="table table-striped">
        <thead class="thead-light">
            <tr>
                <th>#</th>
                <th>用户名</th>
                <th>性别</th>
                <th>电话</th>
                <th>游戏爱好</th>
                <th>段位</th>
                <td>操作</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <th>用户名</th>
                <th>性别</th>
                <th>电话</th>
                <th>游戏爱好</th>
                <th>段位</th>
                <td>
                    <a href="#" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#playerEditDialog" onclick="editplayer(1)">修改</a>
                    <a href="#" class="btn btn-danger btn-xs" onclick="deleteplayer()">删除</a>
               </td>
            </tr>
            <tr>
                <td>2</td>
                <th>用户名</th>
                <th>性别</th>
                <th>电话</th>
                <th>游戏爱好</th>
                <th>段位</th>
                <td><a href="#" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#playerEditDialog" onclick="editplayer(1)">修改</a>
                    <a href="#" class="btn btn-danger btn-xs" onclick="deleteplayer()">删除</a></td>
            </tr>
        </tbody>
    </table>
    <div class="modal fade" id="newplayerDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">新建陪玩人员信息</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" id="new_player_form">
                        <div class="form-group">
                            <label for="new_name" class="col-sm-2 control-label">用户名</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="new_name" placeholder="用户名" name="loginname">
                            </div>
                            <label for="new_gender" class="col-sm-2 control-label">
                             性别</label>
                            <div class="col-sm-4"> 
                                <select class="form-control" id="new_gender" name="gender">
                                    <option value="女">女</option>
                                    <option value="男"">男</option>
                                </select>
                            </div>
                        </div>  
                        
                        <div class="form-group">
                            <label for="new_telephone" class="col-sm-2 control-label">电话号码</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="new_telephone" placeholder="电话号码" name="telephone">
                            </div>
                            <label for="new_love" class="col-sm-2 control-label">游戏爱好</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="new_love" placeholder="游戏爱好" name="love">
                            </div>
                        </div>   
                        <div class="form-group">
                            <label for="new_level" class="col-sm-2 control-label">电话号码</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="new_level" placeholder="段位水平" name="level">
                            </div>
                        </div> 
                        
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="createplayer()">创建用户</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 修改用户模态框 -->
    <div class="modal fade" id="playerEditDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                    <h4 class="modal-title" id="myModalLabel">修改用户信息</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" id="edit_player_form">
                            <input type="hidden" id="edit_id" name="id">
                        <div class="form-group">
                            <label for="edit_userName" class="col-sm-2 control-label">用户名</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="edit_userName" placeholder="用户名" name="loginname">
                            </div>
                            <label for="edit_gender" class="col-sm-2 control-label">性别</label>
                            <div class="col-sm-4">
                                <select class="form-control" id="edit_gender" name="gender">
                                    <option value="女">女</option>
                                    <option value="男">男</option>
                                </select>
                            </div>
                        </div>   
                        
                        <div class="form-group">
                            <label for="edit_telephone" class="col-sm-2 control-label">电话号码</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="edit_telephone" placeholder="电话号码" name="telephone">
                            </div>
                            <label for="edit_love" class="col-sm-2 control-label">游戏爱好</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="edit_love" placeholder="游戏爱好" name="love">
                            </div>
                        </div>   
                        <div class="form-group">
                            <label for="edit_level" class="col-sm-2 control-label">电话号码</label>
                            <div class="col-sm-4">
                                <input type="text" class="form-control" id="edit_level" placeholder="段位水平" name="level">
                            </div>
                        </div> 
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="updateplayer()">保存修改</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        //清空新建用户窗口中的数据
            function clearplayer() {
                $("#new_name").val("");
                $("#new_gender").val("");
                $("#new_telephone").val("");
                $("#new_love").val("");
                $("#new_level").val("");
            }
            // 创建用户
            function createplayer() {
                $.post("player/create.action",
                $("#new_player_form").serialize(),
                function(data){
                    if(data =="OK"){
                        alert("用户创建成功！");
                        window.location.reload();
                    }else{
                        alert("用户创建失败！");
                        window.location.reload();
                    }
                });
            }
            // 通过id获取修改的用户信息
            function editplayer(id) {
                $.ajax({
                    type:"get",
                    url:"player/getplayerById.action",
                    data:{"id":id},
                    success:function(data) {
                        $("#edit_id").val(data.id);
                        $("#edit_name").val(data.name);
                        $("#edit_gender").val(data.gender);
                        $("#edit_telephone").val(data.telephone);
                        $("#edit_love").val(data.love);
                        $("#edit_level").val(data.level);
                    
                    }
                });
            }
            // 执行修改用户操作
            function updateplayer() {
                $.post("player/update.action",
                  $("#edit_player_form").serialize(),
                  function(data){
                    if(data =="OK"){
                        alert("陪玩主播信息更新成功！");
                        window.location.reload();
                    }else{
                        alert("陪玩主播信息更新失败！");
                        window.location.reload();
                    }
                });
            }
            // 删除用户
            function deleteplayer(id) {
                if(confirm('确实要删除该用户吗?')) {
                $.post("player/delete.action",{"id":id},
                function(data){
                        if(data =="OK"){
                            alert("陪玩主播删除成功！");
                            window.location.reload();
                        }else{
                            alert("删除陪玩主播失败！");
                            window.location.reload();
                        }
                    });
                }
            }
        </script>   
</body>
</html>